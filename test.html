<!DOCTYPE html>
<html>
<body>

<img align="top" src="https://www.genivia.com/images/sjot-logo.png"> <b style="font-size:45px">SJOT for JS in action</b>

<h2>JSON source</h2>

This JSON object has an embedded SJOT schema with a @root type that describes its valid PersonDetails content precisely, such as the property types, which properties are optional (e.g.  tags?  and age?), default values for properties (e.g. id?999), inheritance (PersonDetails extends Person), and which properties should occur @all together (e.g. tags and phone should be used together or not at all):

<p id="json"></p>

<h2>JS code to parse JSON and validate</h2>

<pre>
    var obj = JSON.parse(text);

    if (SJOT.validate(obj))
      document.getElementById("demo").innerHTML = obj.id + "&lt;br&gt;" + obj.name + "&lt;br&gt;" + obj.street + "&lt;br&gt;" + obj.phone;
    else
      document.getElementById("demo").innerHTML = "Object is invalid";
</pre>

<h2>SJOT in JSON live test</h2>
<p id="demo"></p>

<h2>SJOT schema live test</h2>
<p id="with"></p>

<script src="sjot.js"></script>

<script>

var text =
'{\n' +
'    "@sjot": {\n\n' +
'        "@root": "#PersonDetails",\n\n' +
'        "Person": {\n' +
'            "id?999": "0..999",\n' +
'            "name":   "string",\n' +
'            "street": "string",\n' +
'            "tags?":  "string{1,}",\n' +
'            "phone?": "([- 0-9]+)",\n' +
'            "@all":   [ [ "tags", "phone" ] ]\n' +
'        },\n\n' +
'        "PersonDetails": {\n' +
'            "@extends": "#Person",\n' +
'            "age?":     "0.."\n' +
'        }\n\n' +
'    },\n\n' +
'    "name":   "John Johnson",\n' +
'    "street": "Oslo West 16",\n' +
'    "tags":   [ "JSON" ],\n' +
'    "phone":  "555 1234567"\n' +
'}';

var schema =
'{\n' + 
'    "person": {\n' +
'        "id?999": "0..999",\n' +
'        "name":   "string",\n' +
'        "street": "string",\n' +
'        "tags?":  "string{1,}",\n' +
'        "phone?": "([- 0-9]+)",\n' +
'        "@all":   [ [ "tags", "phone" ] ]\n' +
'    },\n' +
'    "personDetails": {\n' +
'        "@extends": "#person",\n' +
'        "age?":     "0.."\n' +
'    }\n' +
'}';

document.getElementById("json").innerHTML =
  "<pre>" + text + "</pre>";

var obj = JSON.parse(text);

// validate obj against embedded SJOT
if (SJOT.validate(obj))
  document.getElementById("demo").innerHTML = obj.id + "<br>" + obj.name + "<br>" + obj.street + "<br>" + obj.phone;
else
  document.getElementById("demo").innerHTML = "Object is invalid";

// validate obj against the schema person object type
if (SJOT.validate(obj, "#personDetails", schema))
  document.getElementById("with").innerHTML = obj.id + "<br>" + obj.name + "<br>" + obj.street + "<br>" + obj.phone;
else
  document.getElementById("with").innerHTML = "Object is invalid";

</script>

</body>
</html>
