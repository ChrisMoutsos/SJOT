<!DOCTYPE html>
<html>
<body>

<img align="top" src="https://www.genivia.com/images/sjot-logo.png"> <b style="font-size:45px">SJOT for JS in action</b>

<h2>JSON source:</h2>
<p id="json"></p>

<h2>SJOT in JSON test</h2>
<p id="sjot"></p>

<h2>SJOT schema test</h2>
<p id="with"></p>

<script src="sjot.js"></script>

<script>

var text =
'{\n' +
'    "@sjot": {\n\n' +
'        "@root": "#personDetails",\n\n' +
'        "person": {\n' +
'            "id?999": "0..999",\n' +
'            "name":   "string",\n' +
'            "street": "string",\n' +
'            "tags?":  "string{1,}",\n' +
'            "phone?": "([- 0-9]+)",\n' +
'            "@all":   [ [ "tags", "phone" ] ]\n' +
'        },\n\n' +
'        "personDetails": {\n' +
'            "@extends": "#person",\n' +
'            "age?":     "0.."\n' +
'        }\n\n' +
'    },\n\n' +
'    "name":   "John Johnson",\n' +
'    "street": "Oslo West 16",\n' +
'    "tags":   [ "JSON" ],\n' +
'    "phone":  "555 1234567"\n' +
'}';

var schema =
'{\n' + 
'    "person": {\n' +
'        "id?999": "0..999",\n' +
'        "name":   "string",\n' +
'        "street": "string",\n' +
'        "tags?":  "string{1,}",\n' +
'        "phone?": "([- 0-9]+)",\n' +
'        "@all":   [ [ "tags", "phone" ] ]\n' +
'    },\n' +
'    "personDetails": {\n' +
'        "@extends": "#person",\n' +
'        "age?":     "0.."\n' +
'    }\n' +
'}';

document.getElementById("json").innerHTML =
  "<pre>" + text + "</pre>";

var obj = JSON.parse(text);

// validate obj against embedded SJOT
if (SJOT.validate(obj)) {

  document.getElementById("sjot").innerHTML =
    obj.id + "<br>" +
    obj.name + "<br>" +
    obj.street + "<br>" +
    obj.phone;

}

// validate obj against the schema person object type
if (SJOT.validate(obj, "#personDetails", schema)) {

  document.getElementById("with").innerHTML =
    obj.id + "<br>" +
    obj.name + "<br>" +
    obj.street + "<br>" +
    obj.phone;

}

</script>

</body>
</html>
